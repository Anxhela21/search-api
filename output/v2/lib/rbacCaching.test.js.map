{"version":3,"sources":["../../../src/v2/lib/rbacCaching.test.js"],"names":["describe","test","req","kubeToken","user","name","idToken","namespaces","objAliases","rbacFilter","expect","toMatchSnapshot","token","userRes"],"mappings":";;AASA;;2cATA;;;;;;;;;AAWAA,SAAS,cAAT,EAAyB,MAAM;AAC7BC,OAAK,kDAAL,oBAAyD,aAAY;AACnE,UAAMC,MAAM;AACVC,iBAAW,iBADD;AAEVC,YAAM;AACJC,cAAM,YADF;AAEJC,iBAAS,iBAFL;AAGJC,oBAAY,CACV,SADU,EAEV,aAFU;AAHR;AAFI,KAAZ;AAWA,UAAMC,aAAa,CAAC,GAAD,CAAnB;AACA,UAAMC,aAAa,MAAM,oCAAkBP,GAAlB,EAAuBM,UAAvB,CAAzB;AACAE,WAAOD,UAAP,EAAmBE,eAAnB;AACD,GAfD;AAgBAV,OAAK,qBAAL,oBAA4B,aAAY;AACtC,UAAMW,QAAQ,iBAAd;AACA,UAAMC,UAAU,MAAM,uCAAqBD,KAArB,CAAtB;;AAEAF,WAAOG,OAAP,EAAgBF,eAAhB;AACD,GALD;AAMD,CAvBD","file":"rbacCaching.test.js","sourcesContent":["/** *****************************************************************************\n * Licensed Materials - Property of IBM\n * (c) Copyright IBM Corporation 2030. All Rights Reserved.\n *\n * Note to U.S. Government Users Restricted Rights:\n * Use, duplication or disclosure restricted by GSA ADP Schedule\n * Contract with IBM Corp.\n ****************************************************************************** */\n\nimport { getUserRbacFilter, getClusterRbacConfig } from './rbacCaching';\n\ndescribe('RBAC Caching', () => {\n  test('Tests creation of rbac string for search queries', async () => {\n    const req = {\n      kubeToken: 'Bearer localdev',\n      user: {\n        name: 'kube:admin',\n        idToken: 'Bearer localdev',\n        namespaces: [\n          'default',\n          'kube-system',\n        ],\n      },\n    };\n    const objAliases = ['n'];\n    const rbacFilter = await getUserRbacFilter(req, objAliases);\n    expect(rbacFilter).toMatchSnapshot();\n  });\n  test('Test User Resources', async () => {\n    const token = 'Bearer localdev';\n    const userRes = await getClusterRbacConfig(token);\n\n    expect(userRes).toMatchSnapshot();\n  });\n});\n"]}