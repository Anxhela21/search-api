{"version":3,"sources":["../../../src/v2/mocks/search.js"],"names":["resourceTemplate","cluster","id","kind","name","namespace","status","endpoint","nodes","cpu","memory","storage","node","cpus","role","pod","restarts","creationTimestamp","hostIP","podIP","mockSearchResult","mock","args","mockResult","Object","keys","forEach","i","mockItem","push","MockSearchConnector","isServiceAvailable","runSearchQuery","runSearchQueryCountOnly","getAllProperties","getAllValues","property","findRelationships","count","items","_uid","runApplicationsQuery","runAppClustersQuery","runAppHubSubscriptionsQuery","runAppPodsCountQuery","runAppRemoteSubscriptionsQuery","runGlobalAppChannelsQuery","runGlobalAppClusterCountQuery","runGlobalAppHubSubscriptionsQuery","runGlobalAppRemoteSubscriptionsQuery"],"mappings":";;;;;;;;;;AAAA;;;;;;;;;AASA,MAAMA,mBAAmB;AACvBC,WAASC,OAAO;AACdC,UAAM,SADQ;AAEdC,UAAO,eAAcF,KAAK,CAAL,GAAU,IAAGA,EAAG,EAAhB,GAAoB,EAAG,EAF9B;AAGdG,eAAW,kBAHG;AAIdC,YAAQ,IAJM;AAKdC,cAAU,EALI;AAMdC,WAAO,EANO;AAOdC,SAAK,KAPS;AAQdC,YAAQ,KARM;AASdC,aAAS;AATK,GAAP,CADc;AAYvBC,QAAM,CAACV,KAAK,CAAN,MAAa;AACjBC,UAAM,MADW;AAEjBC,UAAO,cAAaF,EAAG,EAFN;AAGjBW,UAAM,EAHW;AAIjBC,UAAM;AAJW,GAAb,CAZiB;AAkBvBC,OAAKb,OAAO;AACVC,UAAM,KADI;AAEVC,UAAO,eAAcF,KAAK,CAAL,GAAU,IAAGA,EAAG,EAAhB,GAAoB,EAAG,EAFlC;AAGVG,eAAW,aAHD;AAIVW,cAAU,EAJA;AAKVC,uBAAmB,+BALT;AAMVX,YAAQ,SANE;AAOVY,YAAQ,eAPE;AAQVC,WAAO;AARG,GAAP;AAlBkB,CAAzB;;AA8BA;AACA;AACA;;AAEO,MAAMC,8CAAmB;AAC9B;;;;;;;AAOAC,QAAOC,IAAD,IAAU;AACd,UAAMC,aAAa,EAAnB;;AAEA;AACAC,WAAOC,IAAP,CAAYH,IAAZ,EAAkBI,OAAlB,CAA2BvB,IAAD,IAAU;AAClC,WAAK,IAAIwB,IAAI,CAAb,EAAgBA,IAAIL,KAAKnB,IAAL,CAApB,EAAgCwB,KAAK,CAArC,EAAwC;AACtC,cAAMC,wBAAgB5B,iBAAiBG,IAAjB,EAAuBwB,CAAvB,CAAhB,CAAN;AACAJ,mBAAWM,IAAX,CAAgBD,QAAhB;AACD;AACF,KALD;;AAOA,WAAOL,UAAP;AACD;AApB6B,CAAzB;;AAwBP;AACe,MAAMO,mBAAN,CAA0B;AACjCC,oBAAN,GAA2B;AAAA;AACzB,aAAO,IAAP;AADyB;AAE1B;;AAGD;AACMC,gBAAN,GAAuB;AAAA;AACrB,aAAOZ,iBAAiBC,IAAjB,CAAsB,EAAEpB,SAAS,CAAX,EAAcW,MAAM,CAApB,EAAuBG,KAAK,CAA5B,EAAtB,CAAP;AADqB;AAEtB;;AAEKkB,yBAAN,GAAgC;AAAA;AAC9B,aAAO,EAAP;AAD8B;AAE/B;;AAEKC,kBAAN,GAAyB;AAAA;AACvB,aAAO,CAAC,MAAD,EAAS,MAAT,EAAiB,WAAjB,EAA8B,KAA9B,EAAqC,SAArC,CAAP;AADuB;AAExB;;AAEKC,cAAN,CAAmBC,QAAnB,EAA6B;AAAA;AAC3B,cAAQA,QAAR;AACE,aAAK,MAAL;AACE,iBAAO,CAAC,SAAD,EAAY,aAAZ,EAA2B,YAA3B,EAAyC,YAAzC,CAAP;AACF,aAAK,WAAL;AACE,iBAAO,CAAC,SAAD,EAAY,aAAZ,CAAP;AACF,aAAK,KAAL;AACE,iBAAO,CAAC,GAAD,EAAM,GAAN,EAAW,IAAX,CAAP;AACF,aAAK,SAAL;AACE,iBAAO,CAAC,MAAD,EAAS,KAAT,EAAgB,MAAhB,EAAwB,OAAxB,EAAiC,MAAjC,CAAP;AACF;AACE,iBAAO,CAAC,MAAD,EAAS,MAAT,EAAiB,WAAjB,EAA8B,KAA9B,EAAqC,SAArC,CAAP;AAVJ;AAD2B;AAa5B;;AAEKC,mBAAN,GAA0B;AAAA;AACxB,aAAO,CAAC;AACNlC,cAAM,SADA;AAENmC,eAAO,CAFD;AAGNC,eAAO,CAAC;AACNC,gBAAM,KADA,EACOrC,MAAM,SADb,EACwBC,MAAM,aAD9B,EAC6CC,WAAW;AADxD,SAAD;AAHD,OAAD,CAAP;AADwB;AAQzB;;AAED;AACMoC,sBAAN,GAA6B;AAAA;AAC3B,aAAO,CACL;AACE,oBAAY,oDADd;AAEE,uBAAe,sBAFjB;AAGE,yBAAiB,0FAHnB;AAIE,oBAAY,OAJd;AAKE,yBAAiB,QALnB;AAME,wBAAgB;AANlB,OADK,EASL;AACE,oBAAY,0BADd;AAEE,uBAAe,sBAFjB;AAGE,yBAAiB,wFAHnB;AAIE,oBAAY,OAJd;AAKE,yBAAiB,MALnB;AAME,wBAAgB;AANlB,OATK,CAAP;AAD2B;AAmB5B;;AAEKC,qBAAN,GAA4B;AAAA;AAC1B,aAAO,CAAC;AACN,oBAAY,oDADN;AAENJ,eAAO;AAFD,OAAD,CAAP;AAD0B;AAK3B;;AAEKK,6BAAN,GAAoC;AAAA;AAClC,aAAO,CACL;AACE,oBAAY,oDADd;AAEE,oBAAY,oDAFd;AAGE,uBAAe;AAHjB,OADK,EAML;AACE,oBAAY,oDADd;AAEE,oBAAY,oDAFd;AAGE,sBAAc,YAHhB;AAIE,uBAAe;AAJjB,OANK,EAYL;AACE,oBAAY,oDADd;AAEE,oBAAY,oDAFd;AAGE,sBAAc,YAHhB;AAIE,uBAAe;AAJjB,OAZK,CAAP;AADkC;AAoBnC;;AAEKC,sBAAN,GAA6B;AAAA;AAC3B,aAAO,CACL;AACE,oBAAY,oDADd;AAEE,sBAAc;AAFhB,OADK,EAKL;AACE,oBAAY,oDADd;AAEE,sBAAc;AAFhB,OALK,EASL;AACE,oBAAY,oDADd;AAEE,sBAAc;AAFhB,OATK,CAAP;AAD2B;AAe5B;;AAEKC,gCAAN,GAAuC;AAAA;AACrC,aAAO,CACL;AACE,oBAAY,oDADd;AAEE,oBAAY,oDAFd;AAGE,sBAAc;AAHhB,OADK,CAAP;AADqC;AAQtC;;AAED;;;AAGMC,2BAAN,GAAkC;AAAA;AAChC,aAAO,CACL,EAAE,WAAW,kCAAb,EADK,EAEL,EAAE,WAAW,kCAAb,EAFK,CAAP;AADgC;AAKjC;;AAEKC,+BAAN,GAAsC;AAAA;AACpC,aAAO,CACL,EAAE,YAAY,kCAAd,EADK,EAEL,EAAE,YAAY,kCAAd,EAFK,CAAP;AADoC;AAKrC;;AAEKC,mCAAN,GAA0C;AAAA;AACxC,aAAO,CACL;AACE,oBAAY,oDADd;AAEE,oBAAY,oDAFd;AAGE,uBAAe;AAHjB,OADK,EAML;AACE,oBAAY,oDADd;AAEE,oBAAY,oDAFd;AAGE,sBAAc,YAHhB;AAIE,uBAAe;AAJjB,OANK,CAAP;AADwC;AAczC;;AAEKC,sCAAN,GAA6C;AAAA;AAC3C,aAAO,CACL;AACE,oBAAY,0CADd;AAEE,sBAAc;AAFhB,OADK,EAKL;AACE,oBAAY,0CADd;AAEE,sBAAc;AAFhB,OALK,CAAP;AAD2C;AAW5C;AAtKsC;kBAApBnB,mB","file":"search.js","sourcesContent":["/** *****************************************************************************\n * Licensed Materials - Property of IBM\n * (c) Copyright IBM Corporation 2019. All Rights Reserved.\n *\n * Note to U.S. Government Users Restricted Rights:\n * Use, duplication or disclosure restricted by GSA ADP Schedule\n * Contract with IBM Corp.\n ****************************************************************************** */\n\nconst resourceTemplate = {\n  cluster: id => ({\n    kind: 'cluster',\n    name: `mock-cluster${id > 0 ? `-${id}` : ''}`,\n    namespace: 'mock-mcm-cluster',\n    status: 'ok',\n    endpoint: '',\n    nodes: 10,\n    cpu: '30%',\n    memory: '20%',\n    storage: '10%',\n  }),\n  node: (id = 0) => ({\n    kind: 'node',\n    name: `mock-1.1.1.${id}`,\n    cpus: 10,\n    role: 'master',\n  }),\n  pod: id => ({\n    kind: 'pod',\n    name: `mock-cluster${id > 0 ? `-${id}` : ''}`,\n    namespace: 'kube-system',\n    restarts: 20,\n    creationTimestamp: '2018-09-27 16:52:20 -0400 EDT',\n    status: 'Running',\n    hostIP: '179.160.35.59',\n    podIP: '179.160.35.59',\n  }),\n};\n\n// export function repeat(map, count) {\n//   return new Array(count).fill(0).map(map);\n// }\n\nexport const mockSearchResult = {\n  /**\n   * Mock search results.\n   *\n   * Pass the kind and amount of objects to mock.\n   * For example, to mock a search that returns 2 clusters and 5 pods:\n   *    { cluster: 2, pod:5 }\n   */\n  mock: (args) => {\n    const mockResult = [];\n\n    // Get items\n    Object.keys(args).forEach((kind) => {\n      for (let i = 0; i < args[kind]; i += 1) {\n        const mockItem = { ...resourceTemplate[kind](i) };\n        mockResult.push(mockItem);\n      }\n    });\n\n    return mockResult;\n  },\n};\n\n\n/* eslint-disable class-methods-use-this */\nexport default class MockSearchConnector {\n  async isServiceAvailable() {\n    return true;\n  }\n\n\n  // Search Query Mocks\n  async runSearchQuery() {\n    return mockSearchResult.mock({ cluster: 2, node: 3, pod: 5 });\n  }\n\n  async runSearchQueryCountOnly() {\n    return 10;\n  }\n\n  async getAllProperties() {\n    return ['kind', 'name', 'namespace', 'cpu', 'created'];\n  }\n\n  async getAllValues(property) {\n    switch (property) {\n      case 'kind':\n        return ['cluster', 'application', 'deployable', 'compliance'];\n      case 'namespace':\n        return ['default', 'kube-system'];\n      case 'cpu':\n        return ['<', '>', '!='];\n      case 'created':\n        return ['hour', 'day', 'week', 'month', 'year'];\n      default:\n        return ['kind', 'name', 'namespace', 'cpu', 'created'];\n    }\n  }\n\n  async findRelationships() {\n    return [{\n      kind: 'cluster',\n      count: 1,\n      items: [{\n        _uid: '123', kind: 'cluster', name: 'mockCluster', namespace: 'mockCluster-ns',\n      }],\n    }];\n  }\n\n  // Application Query Mocks\n  async runApplicationsQuery() {\n    return [\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'app.created': '2020-01-23T13:56:32Z',\n        'app.dashboard': 'localhost/grafana/dashboard/db/app01-dashboard-via-federated-prometheus?namespace=sample',\n        'app.name': 'app01',\n        'app.namespace': 'sample',\n        'app.selfLink': '/apis/app.k8s.io/v1beta1/namespaces/sample/applications/app01',\n      },\n      {\n        'app._uid': 'local-cluster/app-02-uid',\n        'app.created': '2020-01-23T13:56:32Z',\n        'app.dashboard': 'localhost/grafana/dashboard/db/app02-dashboard-via-federated-prometheus?namespace=test',\n        'app.name': 'app02',\n        'app.namespace': 'test',\n        'app.selfLink': '/apis/app.k8s.io/v1beta1/namespaces/test/applications/app02',\n      },\n    ];\n  }\n\n  async runAppClustersQuery() {\n    return [{\n      'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n      count: 5,\n    }];\n  }\n\n  async runAppHubSubscriptionsQuery() {\n    return [\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'sub._uid': 'local-cluster/bdced01f-3bd4-11ea-a488-00000a100f99',\n        'sub.channel': 'dev1/dev1',\n      },\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'sub._uid': 'local-cluster/b218636d-3d5e-11ea-8ed1-00000a100f99',\n        'sub.status': 'Propagated',\n        'sub.channel': 'default/mortgage-channel',\n      },\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'sub._uid': 'local-cluster/66426f24-3bd3-11ea-a488-00000a100f99',\n        'sub.status': 'Propagated',\n        'sub.channel': 'dev1/dev1',\n      },\n    ];\n  }\n\n  async runAppPodsCountQuery() {\n    return [\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'pod.status': 'Running',\n      },\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'pod.status': 'Running',\n      },\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'pod.status': 'Failed',\n      },\n    ];\n  }\n\n  async runAppRemoteSubscriptionsQuery() {\n    return [\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'sub._uid': 'local-cluster/b218636d-3d5e-11ea-8ed1-00000a100f99',\n        'sub.status': 'Subscribed',\n      },\n    ];\n  }\n\n  /*\n   * Global Application queries mocks.\n   */\n  async runGlobalAppChannelsQuery() {\n    return [\n      { 'ch._uid': 'local-cluster/mock-channel-1-uid' },\n      { 'ch._uid': 'local-cluster/mock-channel-2-uid' },\n    ];\n  }\n\n  async runGlobalAppClusterCountQuery() {\n    return [\n      { 'app._uid': 'local-cluster/mock-cluster-1-uid' },\n      { 'app._uid': 'local-cluster/mock-cluster-2-uid' },\n    ];\n  }\n\n  async runGlobalAppHubSubscriptionsQuery() {\n    return [\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'sub._uid': 'local-cluster/bdced01f-3bd4-11ea-a488-00000a100f99',\n        'sub.channel': 'dev1/dev1',\n      },\n      {\n        'app._uid': 'local-cluster/29a848d6-3de8-11ea-9f0f-00000a100f99',\n        'sub._uid': 'local-cluster/b218636d-3d5e-11ea-8ed1-00000a100f99',\n        'sub.status': 'Propagated',\n        'sub.channel': 'default/mortgage-channel',\n      },\n    ];\n  }\n\n  async runGlobalAppRemoteSubscriptionsQuery() {\n    return [\n      {\n        'sub._uid': 'cluster-1/mock-remote-subscription-2-uid',\n        'sub.status': 'Subscribed',\n      },\n      {\n        'sub._uid': 'cluster-2/mock-remote-subscription-2-uid',\n        'sub.status': 'Propagated',\n      },\n    ];\n  }\n}\n"]}